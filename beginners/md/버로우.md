# 컨슈머 랙 모니터링 애플리케이션, 카프카 버로우(Burrow)

- 카프카 랙을 모니터링하기 위해 오픈소스인 카프카 버로우를 사용해야 하는 이유?

카프카 랙은 토픽의 가장 최신 오프셋과 컨슈머 오프셋 간의 차이이다.

자바나 스칼라에서 구성할 수 있는 카프카 컨슈머 정보를 통해 랙의 정보를 가져올 수 있습니다.

만약 실시간으로 랙의 정보를 판단하고 싶다면 elasticSearch나 influxDb 같은 저장소에 넣은 뒤 그라파나 대시보드를 통해 확인할 수도 있습니다.

문제는 컨슈머단위에서 랙을 보는 것은 아주 위험하고, 리소스가 많이 듭니다.
- 이는 컨슈머 상태에 디펜던시가 걸리기 때문입니다.
- 컨슈머가 비 정상적으로 종료되게 된다면, 더이상 컨슈머는 랙 정보를 보낼 수 없기 때문에 랙을 측정할 수 없습니다
- 추가적으로 컨슈머가 늘어날 때마다 랙을 어딘가에 저장해서 모니터링해야 합니다.


=> 그래서 버로우가 있습니다.

# Burrow

- Golang으로 작성되어 있음
- 지속적으로 관리되고 있는 오픈소스
- 버로우는 컨슈머 랙 모니터링을 도와주는 독립적인 애플리케이션

> 특징

- 멀티 카프카 클러스터 지원
  - 카프카 클러스터가 여러개더라도, 버로우 애플리케이션 1개만 실행해서 연동한다면 카프카 클러스터들에 붙은 컨슈머들의 랙을 모두 모니터링 할 수 있습니다.

![](/images/2022-06-03-16-53-57.png)

- 슬라이딩 윈도우를 통한 컨슈머의 status 확인
  - Error, Warning, OK 3가지 상태로 표현
  - 데이터 양이 많아지고 있는데 컨슈머가 데이터를 가져가지 않으면 Error
  - 데이터 양이 일시적으로 많아져서 컨슈머 오프셋이 증가하면 Warning

- Http API 제공